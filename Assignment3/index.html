<!DOCTYPE html>
<html>
<head>
	<title>Project 1 - sample code</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.2/papaparse.min.js" charset="utf-8"></script>
	<style>
    	text { 
			font-family: Arial; 
			font-size: 15px;
		}
		.axis path, .axis line {
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.tick text {
			fill: black;
			font-size: 11px;
		}
	</style>
</head>
<body>

	<svg id="main" width="600" height="600">
		<text id='label' x='100' y='70'></text>
	</svg>

	<select id="selectionWidget" style="position: absolute; left: 650px; top: 150px">
		
	</select>

	<script>

		var listOfLocalities = [];
		var localities = {};

		d3.csv('data/energy.csv', function(data) 
		{
            for (var i=0; i<data.length; i++)
            console.table(data[i]);
			{
				var record = data[i];
				record.energyProduction = [];

				// loop through all years, from 1980 to 2012
				for (var year=1980; year<=2012; year++) 
				{
					var value = record[year];

					// deal with missing data points
					if (value === '--') {
						value = 0;
					}
					else if (value === 'NA') {
						value = 0;
					}
					else if (value === '(s)') {
						value = 0;
					}
					else if (value === 'W') {
						value = 0;
					}
					
					// add record of current energy production
					record.energyProduction.push( value );

				}

				// create a list of country names
				localities[ record.Locality ] = record;
				listOfLocalities.push( record.Locality );
			}
			dataReady();

		});


		function dataReady() {
			// make bar chart
			drawBarChart('United States');

			// populate selection list
			d3.select('#selectionWidget').selectAll('option').data(listOfLocalities).enter().append('option')
				.html(function(d) { return d; })
				.attr('value', function(d) { return d; })

			d3.select("#selectionWidget")
				.on('change', function() {

					// clear the contents of the chart
					d3.select("#main").selectAll('g').remove();

					// figure out the newly selected locality
					var selection = document.getElementById('selectionWidget');
					var localityName = selection.options[selection.selectedIndex].value;

					console.log('new locality: ' + localityName);

					// re-draw bar chart for the new locality
					drawBarChart(localityName);
				});
		}

		function drawBarChart(localityName)
		{
            // drawing code here
            d3.select('#main')
            .selectAll('rect').data(data)
                .enter().append('rect')
                    .append('rect')
                    .attr('fill', 'blue');
		}
		
	</script>
</body>


</html>